<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>API æ¸¬è©¦å·¥å…·</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            color: #667eea;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: #667eea;
        }
        
        textarea {
            min-height: 100px;
            font-family: monospace;
        }
        
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .result-box {
            margin-top: 30px;
            padding: 20px;
            background: #f5f5f5;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .result-box h3 {
            margin-bottom: 15px;
            color: #667eea;
        }
        
        pre {
            background: white;
            padding: 15px;
            border-radius: 8px;
            overflow-x: auto;
            font-size: 13px;
        }
        
        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .alert-success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .alert-error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª API æ¸¬è©¦å·¥å…·</h1>
        <p style="margin-bottom: 30px; color: #666;">æ¸¬è©¦æ‚¨çš„ API ç«¯é»ï¼Œç¢ºèªè«‹æ±‚å’Œå›æ‡‰æ ¼å¼ã€‚</p>
        
        <form id="test-form">
            <div class="form-group">
                <label for="api-url">API ç«¯é» URL *</label>
                <input type="text" id="api-url" required value="http://34.80.232.70:3002/api/v1/workspace/homi/chat">
            </div>
            
            <div class="form-row">
                <div class="form-group">
                    <label for="api-method">HTTP æ–¹æ³•</label>
                    <select id="api-method">
                        <option value="POST">POST</option>
                        <option value="GET">GET</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="auth-type">èªè­‰æ–¹å¼</label>
                    <select id="auth-type" onchange="updateAuthFields()">
                        <option value="bearer">Bearer Token</option>
                        <option value="api-key">API Key (Header: api-key)</option>
                        <option value="x-api-key">X-API-Key</option>
                        <option value="authorization">Authorization (ç›´æ¥)</option>
                        <option value="custom">è‡ªå®šç¾© Header</option>
                    </select>
                </div>
            </div>
            
            <div class="form-group" id="custom-header-group" style="display: none;">
                <label for="custom-header">è‡ªå®šç¾© Header åç¨±</label>
                <input type="text" id="custom-header" placeholder="ä¾‹å¦‚: X-Custom-Auth">
            </div>
            
            <div class="form-group">
                <label for="api-key">API Key</label>
                <input type="text" id="api-key" value="KYYC4B8-K684SKD-K8RZWR9-HPXTERS">
            </div>
            
            <div class="form-group">
                <label for="request-body">è«‹æ±‚ Body (JSON)</label>
                <textarea id="request-body">{"message": "ä½ å¥½ï¼Œè«‹ä»‹ç´¹ä¸€ä¸‹è‡ªå·±"}</textarea>
            </div>
            
            <button type="submit" class="btn btn-primary">ğŸš€ æ¸¬è©¦ API</button>
        </form>
        
        <div id="result" style="display: none;"></div>
    </div>
    
    <script>
        function updateAuthFields() {
            const authType = document.getElementById('auth-type').value;
            const customHeaderGroup = document.getElementById('custom-header-group');
            customHeaderGroup.style.display = authType === 'custom' ? 'block' : 'none';
        }
        
        document.getElementById('test-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const resultDiv = document.getElementById('result');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = '<div class="alert alert-success">â³ æ­£åœ¨æ¸¬è©¦ API...</div>';
            
            const apiUrl = document.getElementById('api-url').value;
            const method = document.getElementById('api-method').value;
            const authType = document.getElementById('auth-type').value;
            const apiKey = document.getElementById('api-key').value;
            const requestBodyText = document.getElementById('request-body').value;
            
            try {
                // Parse request body
                const requestBody = JSON.parse(requestBodyText);
                
                // Build headers based on auth type
                const headers = {
                    'Content-Type': 'application/json'
                };
                
                switch (authType) {
                    case 'bearer':
                        headers['Authorization'] = `Bearer ${apiKey}`;
                        break;
                    case 'api-key':
                        headers['api-key'] = apiKey;
                        break;
                    case 'x-api-key':
                        headers['X-API-Key'] = apiKey;
                        break;
                    case 'authorization':
                        headers['Authorization'] = apiKey;
                        break;
                    case 'custom':
                        const customHeader = document.getElementById('custom-header').value;
                        if (customHeader) {
                            headers[customHeader] = apiKey;
                        }
                        break;
                }
                
                // Make request
                const startTime = Date.now();
                const response = await fetch(apiUrl, {
                    method: method,
                    headers: headers,
                    body: method === 'POST' ? JSON.stringify(requestBody) : undefined
                });
                
                const endTime = Date.now();
                const responseTime = endTime - startTime;
                
                const responseText = await response.text();
                let responseData;
                
                try {
                    responseData = JSON.parse(responseText);
                } catch {
                    responseData = responseText;
                }
                
                // Display result
                if (response.ok) {
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            âœ… API æ¸¬è©¦æˆåŠŸï¼
                        </div>
                        <div class="result-box">
                            <h3>è«‹æ±‚è³‡è¨Š</h3>
                            <p><strong>URL:</strong> ${apiUrl}</p>
                            <p><strong>æ–¹æ³•:</strong> ${method}</p>
                            <p><strong>ç‹€æ…‹ç¢¼:</strong> ${response.status}</p>
                            <p><strong>å›æ‡‰æ™‚é–“:</strong> ${responseTime}ms</p>
                            
                            <h3 style="margin-top: 20px;">ä½¿ç”¨çš„ Headers</h3>
                            <pre>${JSON.stringify(headers, null, 2)}</pre>
                            
                            <h3 style="margin-top: 20px;">è«‹æ±‚ Body</h3>
                            <pre>${JSON.stringify(requestBody, null, 2)}</pre>
                            
                            <h3 style="margin-top: 20px;">å›æ‡‰å…§å®¹</h3>
                            <pre>${typeof responseData === 'object' ? JSON.stringify(responseData, null, 2) : responseData}</pre>
                            
                            <h3 style="margin-top: 20px;">ğŸ“‹ è©•ä¼°è¡¨å–®é…ç½®å»ºè­°</h3>
                            <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin-top: 10px;">
                                <p><strong>API Key Header:</strong> ${Object.keys(headers).find(k => k.toLowerCase().includes('auth') || k.toLowerCase().includes('key'))}</p>
                                <p><strong>API Key Value:</strong> ${headers[Object.keys(headers).find(k => k.toLowerCase().includes('auth') || k.toLowerCase().includes('key'))]}</p>
                                <p><strong>å•é¡Œæ¬„ä½åç¨±:</strong> ${Object.keys(requestBody)[0]}</p>
                                ${typeof responseData === 'object' ? `<p><strong>å›ç­”æ¬„ä½è·¯å¾‘:</strong> ${Object.keys(responseData).filter(k => k.includes('response') || k.includes('text') || k.includes('answer')).join(', ')}</p>` : ''}
                            </div>
                        </div>
                    `;
                } else {
                    resultDiv.innerHTML = `
                        <div class="alert alert-error">
                            âŒ API æ¸¬è©¦å¤±æ•—
                        </div>
                        <div class="result-box">
                            <h3>éŒ¯èª¤è³‡è¨Š</h3>
                            <p><strong>ç‹€æ…‹ç¢¼:</strong> ${response.status}</p>
                            <p><strong>ç‹€æ…‹æ–‡å­—:</strong> ${response.statusText}</p>
                            
                            <h3 style="margin-top: 20px;">éŒ¯èª¤å›æ‡‰</h3>
                            <pre>${typeof responseData === 'object' ? JSON.stringify(responseData, null, 2) : responseData}</pre>
                            
                            <h3 style="margin-top: 20px;">ğŸ’¡ å¯èƒ½çš„è§£æ±ºæ–¹æ¡ˆ</h3>
                            <ul style="margin-left: 20px; margin-top: 10px;">
                                <li>æª¢æŸ¥ API Key æ˜¯å¦æ­£ç¢º</li>
                                <li>å˜—è©¦ä¸åŒçš„èªè­‰æ–¹å¼ï¼ˆä½¿ç”¨ä¸Šæ–¹ä¸‹æ‹‰é¸å–®ï¼‰</li>
                                <li>ç¢ºèªå·¥ä½œå€ slug (homi) æ˜¯å¦æ­£ç¢º</li>
                                <li>æª¢æŸ¥ API ç«¯é»è·¯å¾‘æ˜¯å¦æ­£ç¢º</li>
                                <li>ç¢ºèªç¶²è·¯é€£ç·šæ­£å¸¸</li>
                            </ul>
                        </div>
                    `;
                }
            } catch (error) {
                resultDiv.innerHTML = `
                    <div class="alert alert-error">
                        âŒ éŒ¯èª¤ï¼š${error.message}
                    </div>
                `;
            }
        });
    </script>
</body>
</html>

