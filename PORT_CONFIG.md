# ç«¯å£é…ç½®èªªæ˜

## ğŸ“Œ çµ±ä¸€ç«¯å£é…ç½®

æœ¬é …ç›®ä½¿ç”¨çµ±ä¸€çš„ç«¯å£é…ç½®è®Šæ•¸ `API_PORT`ã€‚**åªéœ€ä¿®æ”¹ä¸€å€‹åœ°æ–¹å³å¯æ”¹è®Šæ‰€æœ‰ç«¯å£è¨­ç½®**ã€‚

## ğŸ¯ ä¿®æ”¹ç«¯å£çš„æ–¹æ³•

### æ–¹æ³• 1: ä½¿ç”¨ .env æ–‡ä»¶ï¼ˆæ¨è–¦ï¼‰

1. **ä¿®æ”¹ `.env` æ–‡ä»¶**ï¼ˆå¦‚æœä¸å­˜åœ¨ï¼Œå¾ `env.example` è¤‡è£½ï¼‰ï¼š
   ```bash
   # åœ¨ .env æ–‡ä»¶ä¸­è¨­ç½®ç«¯å£
   API_PORT=3010
   ```

2. **é‡æ–°å•Ÿå‹•æœå‹™**ï¼š
   ```bash
   docker-compose down
   docker-compose up -d --build
   ```

### æ–¹æ³• 2: ä½¿ç”¨ç’°å¢ƒè®Šæ•¸

```bash
# è¨­ç½®ç’°å¢ƒè®Šæ•¸
export API_PORT=3010

# å•Ÿå‹•æœå‹™
docker-compose up -d --build
```

### æ–¹æ³• 3: ç›´æ¥åœ¨ docker-compose.yml ä¸­ä¿®æ”¹

ç·¨è¼¯ `docker-compose.yml`ï¼Œä¿®æ”¹ä»¥ä¸‹è¡Œï¼š
```yaml
ports:
  - "${API_PORT:-3010}:${API_PORT:-3010}"  # å°‡ 3010 æ”¹ç‚ºä½ æƒ³è¦çš„ç«¯å£
```

ç„¶å¾Œåœ¨ç’°å¢ƒè®Šæ•¸éƒ¨åˆ†ä¹Ÿä¿®æ”¹ï¼š
```yaml
environment:
  - API_PORT=${API_PORT:-3010}  # å°‡ 3010 æ”¹ç‚ºä½ æƒ³è¦çš„ç«¯å£
```

## ğŸ“‹ ç«¯å£é…ç½®å½±éŸ¿çš„ç¯„åœ

ä¿®æ”¹ `API_PORT` å¾Œï¼Œä»¥ä¸‹ä½ç½®æœƒè‡ªå‹•ä½¿ç”¨æ–°ç«¯å£ï¼š

1. âœ… **Docker å®¹å™¨ç«¯å£æ˜ å°„** - `docker-compose.yml`
2. âœ… **æ‡‰ç”¨ç¨‹åºç›£è½ç«¯å£** - é€šé `settings.py` è®€å–ç’°å¢ƒè®Šæ•¸
3. âœ… **å¥åº·æª¢æŸ¥** - Docker healthcheck è…³æœ¬
4. âœ… **å•Ÿå‹•è…³æœ¬** - Docker entrypoint è…³æœ¬
5. âœ… **å‰ç«¯ API èª¿ç”¨** - `static/app.js`ï¼ˆéœ€è¦æ‰‹å‹•æ›´æ–°ï¼Œæˆ–ä½¿ç”¨ç›¸å°è·¯å¾‘ï¼‰

## ğŸ”§ é…ç½®æ–‡ä»¶èªªæ˜

### ä¸»è¦é…ç½®æ–‡ä»¶

1. **`.env` æˆ– `env.example`**
   - å®šç¾© `API_PORT=3010`
   - é€™æ˜¯**ä¸»è¦çš„é…ç½®ä½ç½®**

2. **`docker-compose.yml`**
   - ä½¿ç”¨ `${API_PORT:-3010}` è®€å–ç’°å¢ƒè®Šæ•¸
   - è¨­ç½®ç«¯å£æ˜ å°„å’Œç’°å¢ƒè®Šæ•¸

3. **`Dockerfile`**
   - ä½¿ç”¨ entrypoint è…³æœ¬è®€å– `API_PORT` ç’°å¢ƒè®Šæ•¸
   - å¥åº·æª¢æŸ¥è…³æœ¬ä¹Ÿè®€å–ç’°å¢ƒè®Šæ•¸

4. **`configs/settings.py`**
   - å¾ç’°å¢ƒè®Šæ•¸ `API_PORT` è®€å–ç«¯å£
   - é è¨­å€¼ç‚º 3010

### è…³æœ¬æ–‡ä»¶

1. **`docker-entrypoint.sh`**
   - å•Ÿå‹•è…³æœ¬ï¼Œå¾ç’°å¢ƒè®Šæ•¸è®€å–ç«¯å£
   - å•Ÿå‹• uvicorn æœå‹™å™¨

2. **`docker-healthcheck.sh`**
   - å¥åº·æª¢æŸ¥è…³æœ¬ï¼Œå¾ç’°å¢ƒè®Šæ•¸è®€å–ç«¯å£
   - æª¢æŸ¥ `/health` ç«¯é»

## ğŸ“ æ³¨æ„äº‹é …

1. **å‰ç«¯é…ç½®**: `static/app.js` ä¸­çš„ `API_BASE_URL` éœ€è¦æ‰‹å‹•æ›´æ–°ï¼Œæˆ–ä½¿ç”¨ç›¸å°è·¯å¾‘
2. **ç«¯å£ç¯„åœ**: å»ºè­°ä½¿ç”¨ 3000-9999 ç¯„åœçš„ç«¯å£ï¼Œé¿å…ç³»çµ±ä¿ç•™ç«¯å£
3. **é‡æ–°æ§‹å»º**: ä¿®æ”¹ç«¯å£å¾Œï¼Œå»ºè­°é‡æ–°æ§‹å»º Docker é¡åƒï¼š`docker-compose build`
4. **ç’°å¢ƒè®Šæ•¸å„ªå…ˆç´š**: `.env` æ–‡ä»¶ > ç’°å¢ƒè®Šæ•¸ > é»˜èªå€¼ (3010)

## ğŸš€ å¿«é€Ÿæ¸¬è©¦

```bash
# è¨­ç½®æ–°ç«¯å£
export API_PORT=8080

# é‡æ–°æ§‹å»ºä¸¦å•Ÿå‹•
docker-compose down
docker-compose up -d --build

# æ¸¬è©¦
curl http://localhost:8080/health
```

## ğŸ“š ç›¸é—œæ–‡ä»¶

- `docker-compose.yml` - Docker Compose é…ç½®
- `Dockerfile` - Docker é¡åƒæ§‹å»ºé…ç½®
- `docker-entrypoint.sh` - å®¹å™¨å•Ÿå‹•è…³æœ¬
- `docker-healthcheck.sh` - å®¹å™¨å¥åº·æª¢æŸ¥è…³æœ¬
- `configs/settings.py` - æ‡‰ç”¨ç¨‹åºé…ç½®
- `.env` / `env.example` - ç’°å¢ƒè®Šæ•¸é…ç½®

